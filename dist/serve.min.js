"use strict";import constants from"/constants";function checkEmail(t){return!!constants.REGEX_EMAIL.test(t)||(alert(constants.CHECK_EMAIL),!1)}function checkError(t){t.response?alert(t.response.data.message):console.log(t)}function checkNumber(t,e=constants.NUM_MIN,r=constants.NUM_MAX){return e<=(t=Number(t))&&t<=r||(alert(constants.CHECK_NUMBER+` ${e} & ${r} !`),!1)}function checkPass(t){return!!constants.REGEX_PASS.test(t)||(alert(constants.CHECK_PASS),!1)}function checkRole(t,e){let r=null;switch(t){case"admin":r=!0;break;case"editor":r="admin"!==e;break;case"user":r="user"===e;break;default:r=!1}return r}function checkString(t,e=constants.STRING_MIN,r=constants.STRING_MAX){return(t=String(t)).length>=e&&t.length<=r||(alert(constants.CHECK_STRING+` ${e} & ${r} !`),!1)}function checkUrl(t){return!!constants.REGEX_URL.test(t)||(alert(constants.CHECK_URL),!1)}function checkUser(t){for(var e of t)if(e===constants.USER_ID)return!0;return!1}async function fetchGet(t){t=t.startsWith("http")?t:constants.API_URL+t;let e;var r=await fetch(t);if(!r.ok)throw new Error(r.text());switch(r.headers.get("Content-Type").split(";")[0]){case"application/json":e=await r.json();break;case"multipart/form-data":e=await r.formData();break;case"text/html":case"text/plain":e=await r.text();break;default:e=r.body}return e}async function fetchPost(t,e){t=t.startsWith("http")?t:constants.API_URL+t;e={method:"POST",mode:"cors",headers:{Authorization:"Bearer "+constants.TOKEN},body:e},t=await fetch(t,e);if(t.ok)return t.json();throw new Error(t.text())}async function fetchPatch(t,e){t=t.startsWith("http")?t:constants.API_URL+t;e={method:"PATCH",mode:"cors",headers:{Authorization:"Bearer "+constants.TOKEN},body:e},t=await fetch(t,e);if(t.ok)return t.json();throw new Error(t.text())}async function fetchPut(t,e){t=t.startsWith("http")?t:constants.API_URL+t;e={method:"PUT",mode:"cors",headers:{Authorization:"Bearer "+constants.TOKEN},body:e},t=await fetch(t,e);if(t.ok)return t.json();throw new Error(t.text())}async function fetchDelete(t){t=t.startsWith("http")?t:constants.API_URL+t;var e={method:"DELETE",mode:"cors",headers:{Authorization:"Bearer "+constants.TOKEN}},t=await fetch(t,e);if(t.ok)return t.json();throw new Error(t.text())}function getAverage(t,e){var r,o,n,c={},s=[];for(r of e)c[r.product]?(c[r.product].sum+=r.score,c[r.product].n++):c[r.product]={sum:r.score,n:1};for(o of Object.keys(c))s.push({product:o,score:c[o].sum/c[o].n});for(n of s)if(t===n.product)return n.score}function getCats(t){var e,r=new Set;for(e of t)r.add(e.cat);return Array.from(r)}function getItemName(t,e){for(var r of e)if(r._id===t)return r.name;return!1}function getItemsByCat(t){var e,r={};for(e of t)r[e.cat]||(r[e.cat]=[]),r[e.cat].push(e),r[e.cat].sort((t,e)=>t.name>e.name?1:-1);return r}function setDescription(t){document.querySelector('[name="description"]').setAttribute("content",t),document.querySelector('[property="og:description"]')&&document.querySelector('[property="og:description"]').setAttribute("content",t),document.querySelector('[name="twitter:description"]')&&document.querySelector('[name="twitter:description"]').setAttribute("content",t)}function setGlobalMeta(t=constants.LANG,e=constants.ICON,r=constants.TW_ID){document.querySelector("html").setAttribute("lang",t),document.querySelector('[rel="icon"]').setAttribute("href",e),document.querySelector('[name="twitter:creator"]')&&document.querySelector('[name="twitter:creator"]').setAttribute("content",r)}function setImage(t){document.querySelector('[property="og:image"]')&&document.querySelector('[property="og:image"]').setAttribute("content",t),document.querySelector('[name="twitter:image"]')&&document.querySelector('[name="twitter:image"]').setAttribute("content",t)}function setMeta(t,e,r,o=""){setTitle(t),setDescription(e),setUrl(r),""!==o&&setImage(o)}function setTitle(t){document.querySelector("title").textContent=t,document.querySelector('[property="og:title"]')&&document.querySelector('[property="og:title"]').setAttribute("content",t),document.querySelector('[name="twitter:title"]')&&document.querySelector('[name="twitter:title"]').setAttribute("content",t)}function setUrl(t){document.querySelector('[rel="canonical"]').setAttribute("href",t),document.querySelector('[property="og:url"]')&&document.querySelector('[property="og:url"]').setAttribute("content",t),document.querySelector('[name="twitter:site"]')&&document.querySelector('[name="twitter:site"]').setAttribute("content",t)}export default{checkEmail:checkEmail,checkError:checkError,checkNumber:checkNumber,checkPass:checkPass,checkRole:checkRole,checkString:checkString,checkUrl:checkUrl,checkUser:checkUser,fetchDelete:fetchDelete,fetchGet:fetchGet,fetchPatch:fetchPatch,fetchPost:fetchPost,fetchPut:fetchPut,getAverage:getAverage,getCats:getCats,getItemName:getItemName,getItemsByCat:getItemsByCat,setDescription:setDescription,setGlobalMeta:setGlobalMeta,setImage:setImage,setMeta:setMeta,setTitle:setTitle,setUrl:setUrl};